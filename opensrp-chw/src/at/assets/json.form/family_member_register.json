{
  "validate_on_submit": true,
  "show_errors_on_submit": true,
  "count": "2",
  "encounter_type": "Family Member Registration",
  "entity_id": "",
  "relational_id": "",
  "metadata": {
    "start": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "start",
      "openmrs_entity_id": "163137AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "end": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "end",
      "openmrs_entity_id": "163138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "today": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "encounter",
      "openmrs_entity_id": "encounter_date"
    },
    "deviceid": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "deviceid",
      "openmrs_entity_id": "163149AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "subscriberid": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "subscriberid",
      "openmrs_entity_id": "163150AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "simserial": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "simserial",
      "openmrs_entity_id": "163151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "phonenumber": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "phonenumber",
      "openmrs_entity_id": "163152AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "encounter_location": "",
    "look_up": {
      "entity_id": "",
      "value": ""
    }
  },
  "step1": {
    "title": "Consent Form",
    "next": "step2",
    "fields": [
      {
        "key": "consent_message",
        "openmrs_entity_parent": "",
        "openmrs_entity": "",
        "openmrs_entity_id": "toaster_notes",
        "type": "toaster_notes",
        "text": "The Afya Tek program goal is to coordinate care to ensure prompt access to care among families in Kibaha.\n\nAs part of improving access to care and referral coordination, we need to register all household members in Kibaha so that we are able to follow specific individuals (children, adolescents, pregnant and post-partum mothers) as they navigate through multiple points of care and ensure that they receive respective and better care. Household membersâ€™ registration will involve scanning your fingerprints so that the program is able to identify you and match you to your health records. Your fingerprints and related information collected will be treated as strictly confidential and handled in accordance with relevant data protection standards\n\nIndividuals who are ANC, PNC, adolescents or children under 5 will be visited by a CHV during and after pregnancy, counseled and evaluated for danger signs. The individual will then be referred, as needed, to the health facility or linked to an ADDO and followed up by the CHV to ensure continuity and quality of care. \n\nDo you consent to participate in the program? ",
        "text_color": "#1199F9",
        "toaster_type": "warning"
      },
      {
        "key": "member_consent",
        "openmrs_entity_parent": "",
        "openmrs_entity": "",
        "openmrs_entity_id": "",
        "type": "check_box",
        "exclusive": [
          "chk_consent_yes"
        ],
        "label": "Does the person consent to enroll in the program?",
        "options": [
          {
            "key": "chk_consent_yes",
            "text": "Yes",
            "text_size": "18px",
            "value": "false"
          },
          {
            "key": "chk_consent_no",
            "text": "No",
            "text_size": "18px",
            "value": "false"
          }
        ],
        "v-required" : {
          "value" : "true",
          "err": "Please fill household consent"
        }
      }
    ]
  },
  "step2":  {
     "title": "Add Family Member",
     "fields": [
       {
         "key": "unique_id",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person_identifier",
         "openmrs_entity_id": "opensrp_id",
         "type": "edit_text",
         "hint": "Afya-Tek ID",
         "read_only": "true",
         "v_numeric": {
           "value": "true",
           "err": "Please enter a valid ID"
         },
         "v_required": {
           "value": "true",
           "err": "Please enter the UNIQUE ID"
         },
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "surname",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "edit_text",
         "hint": "Surname",
         "edit_type": "name",
         "v_regex": {
           "value": "[A-Za-z\\u00C0-\\u017F\\s\\u00C0-\\u017F\\.\\-]*",
           "err": "Please enter a valid name"
         },
         "v_required": {
           "value": "true",
           "err": "Please enter the surname"
         },
         "relevance": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_relevance.yml"
             }
           }
         }
       },
       {
         "key": "same_as_fam_name",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "openmrs_data_type": "text",
         "type": "check_box",
         "label": "",
         "exclusive": [
           "none"
         ],
         "options": [
           {
             "key": "same_as_fam_name",
             "text": "Surname same as family name",
             "text_size": "18px",
             "value": "false"
           }
         ],
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "fam_name",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "label",
         "hidden": "true",
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "surname_calculation",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person",
         "openmrs_entity_id": "last_name",
         "type": "hidden",
         "hint": "Surname as Family name",
         "calculation": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family-member-calculation.yml"
             }
           }
         }
       },
       {
         "key": "first_name",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person",
         "openmrs_entity_id": "first_name",
         "type": "edit_text",
         "hint": "First name",
         "edit_type": "name",
         "v_required": {
           "value": "true",
           "err": "Please enter the first name"
         },
         "v_regex": {
           "value": "[A-Za-z\\u00C0-\\u017F\\s\\u00C0-\\u017F\\.\\-]*",
           "err": "Please enter a valid name"
         },
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "middle_name",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person",
         "openmrs_entity_id": "middle_name",
         "type": "edit_text",
         "hint": "Middle name",
         "edit_type": "name",
         "v_regex": {
           "value": "[A-Za-z\\u00C0-\\u017F\\s\\u00C0-\\u017F\\.\\-]*",
           "err": "Please enter a valid name"
         },
         "v_required": {
           "value": "true",
           "err": "Please enter the middle name"
         },
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "dob",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person",
         "openmrs_entity_id": "birthdate",
         "type": "date_picker",
         "hint": "Date of birth (DOB)",
         "expanded": false,
         "duration": {
           "label": "Age"
         },
         "min_date": "today-120y",
         "max_date": "today-5y",
         "v_required": {
           "value": "true",
           "err": "Please enter the date of birth"
         },
         "relevance": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_relevance.yml"
             }
           }
         }
       },
       {
         "key": "age_calculated",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "hidden",
         "calculation": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_register_calculation.yml"
             }
           }
         },
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "dob_unknown",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person",
         "openmrs_entity_id": "birthdateApprox",
         "type": "check_box",
         "label": "",
         "options": [
           {
             "key": "dob_unknown",
             "text": "DOB unknown?",
             "text_size": "18px",
             "value": "false"
           }
         ],
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "age",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person_attribute",
         "openmrs_entity_id": "age",
         "type": "edit_text",
         "hint": "Age",
         "v_numeric": {
           "value": "true",
           "err": "Number must begin with 0 and must be a total of 10 digits in length"
         },
         "v_min": {
           "value": "5",
           "err": "Age must be equal or greater than 5"
         },
         "v_max": {
           "value": "120",
           "err": "Age must be equal or less than 120"
         },
         "relevance": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_relevance.yml"
             }
           }
         },
         "v_required": {
           "value": true,
           "err": "Please enter the age"
         }
       },
       {
         "key": "dob_calculated",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "hidden",
         "calculation": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_register_calculation.yml"
             }
           }
         }
       },
       {
         "key": "finger_print",
         "openmrs_entity_parent": "",
         "openmrs_entity": "",
         "openmrs_entity_id": "",
         "type": "finger_print",
         "project_id":"fUBnpzDdbsCsMp0egCHB",
         "user_id":"global_user",
         "module_id":"global_module",
         "finger_print_option":"register",
         "uploadButtonText": "Take finger print",
         "image_file": "",
         "extra_info": {
           "DOB": "dob_calculated"
         },
         "v_required": {
           "value": "true",
           "err": "Please scan fingerprint"
         },
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "sex",
         "openmrs_entity_parent": "",
         "openmrs_entity": "person",
         "openmrs_entity_id": "gender",
         "type": "spinner",
         "hint": "Sex",
         "values": [
           "Male",
           "Female"
         ],
         "keys": [
           "Male",
           "Female"
         ],
         "v_required": {
           "value": "true",
           "err": "Please enter the sex"
         },
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "wra",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "hidden",
         "calculation": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_register_calculation.yml"
             }
           }
         }
       },
       {
         "key": "mra",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "hidden",
         "calculation": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_register_calculation.yml"
             }
           }
         }
       },
       {
         "key": "preg_1yr",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "160692AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
         "type": "spinner",
         "hint": "Has the woman delivered in the last 1 year?",
         "values": [
           "Yes",
           "No"
         ],
         "keys": [
           "Yes",
           "No"
         ],
         "openmrs_choice_ids": {
           "Yes": "1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
           "No": "1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
         },
         "v_required": {
           "value": "true",
           "err": "Please select if the woman has delivered in the last 1 year"
         },
         "relevance": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_relevance.yml"
             }
           }
         }
       },
       {
         "key": "is_primary_caregiver",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "spinner",
         "hint": "Is primary caregiver?",
         "values": [
           "Yes",
           "No"
         ],
         "keys": [
           "Yes",
           "No"
         ],
         "v_required": {
           "value": "true",
           "err": "Please select one"
         },
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "or": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       },
       {
         "key": "phone_number",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "159635AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
         "type": "edit_text",
         "hint": "Phone number",
         "v_numeric": {
           "value": "true",
           "err": "Number must be a total of 10 digits in length"
         },
         "v_regex": {
           "value": "(0[0-9]{9})|\\s*",
           "err": "Number must be 10 digits and must start with 0."
         },
         "v_required": {
           "value": false,
           "err": "Please specify the phone number"
         },
         "relevance": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_relevance.yml"
             }
           }
         }
       },
       {
         "key": "other_phone_number",
         "openmrs_entity_parent": "159635AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
         "type": "edit_text",
         "hint": "Other phone number",
         "v_numeric": {
           "value": "true",
           "err": "Number must be a total of 10 digits in length"
         },
         "v_regex": {
           "value": "(0[0-9]{9})|\\s*",
           "err": "Number must be 10 digits and must start with 0."
         },
         "relevance": {
           "rules-engine": {
             "ex-rules": {
               "rules-file": "family_member_relevance.yml"
             }
           }
         }
       },
       {
         "key": "consent_toaster",
         "openmrs_entity_parent": "",
         "openmrs_entity": "concept",
         "openmrs_entity_id": "",
         "type": "toaster_notes",
         "text": "Consent has not been received to register this individual",
         "text_color": "#CF0800",
         "toaster_type": "problem",
         "relevance": {
           "step1:member_consent": {
             "ex-checkbox": [
               {
                 "not": [
                   "chk_consent_yes"
                 ]
               }
             ]
           }
         }
       }
     ]
  }
}